<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web-–ø—Ä–æ—Å–º–æ—Ç—Ä—â–∏–∫ –ª–æ–≥–æ–≤ v{{.Version}}</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        html, body {
            height: 100%;
            overflow: hidden;
            background-color: #f5f5f5;
        }
        
        body {
            color: #333;
            line-height: 1.6;
            padding: 10px;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
        }
        
        .container {
            height: 100%;
            width: 100%;
            background-color: white;
            border-radius: 6px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background-color: #404040;
            color: white;
            padding: 10px 20px;
            border-bottom: 1px solid #505050;
            flex-shrink: 0;
        }
        
        .app-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .app-version {
            font-size: 0.8rem;
            opacity: 0.8;
            background-color: #505050;
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        .server-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            font-size: 0.8rem;
            color: #ccc;
        }
        
        .server-status {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #2ecc71;
        }

        .status-indicator.online {
            background-color: #2ecc71;
            animation: pulse 1.5s infinite;
        }

        .status-indicator.offline {
            background-color: #e74c3c;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .server-params {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 5px;
            font-size: 0.75rem;
            color: #aaa;
        }
        
        .param-item {
            background-color: #505050;
            padding: 2px 6px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .param-icon {
            font-size: 0.8em;
        }

        .last-check {
            font-size: 0.7rem;
            opacity: 0.7;
            margin-left: 8px;
        }
        
        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
            min-height: 0;
            position: relative;
        }
        
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .loading-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        
        .files-panel {
            width: 300px;
            background-color: #f8f8f8;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: width 0.3s ease;
            position: relative;
            flex-shrink: 0;
        }

        .files-panel.collapsed {
            width: 40px;
        }

        .files-panel.collapsed .files-header-content,
        .files-panel.collapsed .files-list-container {
            display: none;
        }
        
        .files-header {
            padding: 10px 15px;
            background-color: #606060;
            color: white;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 40px;
            position: relative;
            z-index: 10;
            flex-shrink: 0;
        }

        .files-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .files-header-collapsed {
            display: none;
            width: 100%;
            height: 100%;
            align-items: center;
            justify-content: center;
        }

        .files-panel.collapsed .files-header-collapsed {
            display: flex;
        }

        .files-panel.collapsed .files-header-content {
            display: none;
        }

        .toggle-files-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            padding: 4px 8px;
            border-radius: 3px;
            transition: background-color 0.2s, transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            flex-shrink: 0;
        }

        .toggle-files-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .toggle-files-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .files-panel.collapsed .toggle-files-btn {
            margin: 0 auto;
        }
        
        .files-controls {
            display: flex;
            gap: 6px;
            align-items: center;
        }
        
        .btn {
            padding: 5px 10px;
            background-color: #707070;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: background-color 0.2s;
        }
        
        .btn:hover:not(:disabled) {
            background-color: #808080;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-success {
            background-color: #5a7d5a;
        }
        
        .btn-success:hover:not(:disabled) {
            background-color: #6a8d6a;
        }

        .btn-info {
            background-color: #3498db;
        }
        
        .btn-info:hover:not(:disabled) {
            background-color: #2980b9;
        }
        
        .files-list-container {
            flex: 1;
            overflow-y: auto;
            padding: 5px;
            transition: opacity 0.3s;
            min-height: 0;
        }

        .files-panel.collapsed .files-list-container {
            opacity: 0;
            pointer-events: none;
        }
        
        .files-list {
            list-style-type: none;
        }
        
        .directory-item {
            padding: 6px 5px 3px 5px;
            color: #555;
            font-weight: 600;
            font-size: 0.75rem;
            border-bottom: 1px solid #ddd;
            margin-top: 6px;
            background-color: #e8e8e8;
            border-radius: 3px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .directory-toggle {
            background: none;
            border: none;
            color: #555;
            cursor: pointer;
            font-size: 0.75rem;
            padding: 2px 5px;
            border-radius: 3px;
            transition: background-color 0.2s;
            flex-shrink: 0;
        }

        .directory-toggle:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .directory-files {
            transition: max-height 0.3s ease;
            overflow: hidden;
        }

        .directory-item.collapsed + .directory-files {
            max-height: 0;
        }
        
        .directory-item:first-child {
            margin-top: 0;
        }
        
        .file-item {
            padding: 6px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .file-item:hover:not(.disabled) {
            background-color: #e8f0f8;
        }
        
        .file-item.active {
            background-color: #707070;
            color: white;
        }
        
        .file-item.disabled {
            opacity: 0.5;
            cursor: wait;
        }
        
        .file-info {
            flex: 1;
            overflow: hidden;
            min-width: 0;
        }
        
        .file-name {
            font-weight: 500;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .file-meta {
            display: flex;
            gap: 8px;
            font-size: 0.7rem;
            color: #888;
        }
        
        .file-item.active .file-meta {
            color: #ccc;
        }
        
        .file-actions {
            display: flex;
            gap: 4px;
            align-items: center;
            flex-shrink: 0;
        }
        
        .download-btn {
            background-color: #5a7d5a;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.7rem;
            padding: 3px 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }
        
        .download-btn:hover {
            background-color: #6a8d6a;
        }
        
        .file-item.active .download-btn {
            background-color: #8aab8a;
        }
        
        .log-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-width: 0;
        }
        
        .log-header {
            padding: 10px 15px;
            background-color: #606060;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        .log-title {
            font-weight: 500;
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
            margin-right: 10px;
        }
        
        .log-controls {
            display: flex;
            gap: 6px;
            align-items: center;
            flex-shrink: 0;
        }
        
        .nav-btn {
            padding: 5px 8px;
            background-color: #707070;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: background-color 0.2s;
            white-space: nowrap;
        }
        
        .nav-btn:hover:not(:disabled) {
            background-color: #808080;
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .auto-refresh-control {
            display: flex;
            gap: 4px;
            align-items: center;
            white-space: nowrap;
        }
        
        .interval-input {
            width: 45px;
            padding: 3px;
            border: 1px solid #808080;
            border-radius: 3px;
            background-color: #505050;
            color: white;
            text-align: center;
            font-size: 0.75rem;
        }
        
        .interval-input:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .interval-input:focus {
            outline: none;
            border-color: #909090;
        }
        
        .log-content-container {
            flex: 1;
            overflow: auto;
            padding: 0;
            background-color: #1a1a1a;
            color: #d0d0d0;
            position: relative;
            min-height: 0;
        }
        
        .log-content {
            padding: 10px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.75rem;
            white-space: pre;
            line-height: 1.3;
            min-width: 100%;
            display: inline-block;
        }
        
        .log-line {
            display: flex;
            min-height: 16px;
            user-select: text;
            cursor: pointer;
            transition: background-color 0.2s;
            border-radius: 2px;
            margin: 1px 0;
        }

        .log-line:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .line-number {
            color: #6a9955;
            min-width: 45px;
            padding-right: 10px;
            text-align: right;
            user-select: none;
            flex-shrink: 0;
            cursor: pointer;
            transition: color 0.2s, background-color 0.2s;
            border-radius: 2px;
            padding-left: 3px;
        }
        
        .line-number:hover {
            background-color: rgba(106, 153, 85, 0.2);
            color: #8bc34a;
        }
        
        .line-content {
            white-space: pre;
            flex: 1;
            user-select: text;
            padding-right: 3px;
        }
        
        .stats {
            padding: 6px 12px;
            background-color: #f8f8f8;
            border-top: 1px solid #e0e0e0;
            font-size: 0.75rem;
            color: #555;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
            white-space: nowrap;
            overflow: hidden;
        }
        
        .stats-info {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
            margin-right: 10px;
        }
        
        .stats-refresh {
            flex-shrink: 0;
        }
        
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #888;
            text-align: center;
            padding: 30px 15px;
        }
        
        .empty-state-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            opacity: 0.5;
        }
        
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #707070;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å—Ç—Ä–æ–∫–∏ –ª–æ–≥–∞ */
        .line-dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .line-dialog-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .line-dialog {
            background-color: #2c3e50;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }

        .dialog-header {
            background-color: #34495e;
            padding: 12px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #404b5a;
        }

        .dialog-title {
            font-size: 1rem;
            font-weight: 600;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dialog-close {
            background: none;
            border: none;
            color: #aaa;
            font-size: 1.3rem;
            cursor: pointer;
            padding: 0;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.2s, color 0.2s;
        }

        .dialog-close:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .dialog-content {
            padding: 15px;
            overflow-y: auto;
            flex: 1;
        }

        .dialog-section {
            margin-bottom: 15px;
        }

        .dialog-section-title {
            font-size: 0.85rem;
            color: #95a5a6;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .raw-line-content {
            background-color: #1a1a1a;
            border: 1px solid #404b5a;
            border-radius: 4px;
            padding: 8px;
            font-family: 'Consolas', monospace;
            font-size: 0.8rem;
            color: #d0d0d0;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 150px;
            overflow-y: auto;
            margin-bottom: 8px;
        }

        .json-viewer {
            background-color: #1a1a1a;
            border: 1px solid #404b5a;
            border-radius: 4px;
            padding: 12px;
            font-family: 'Consolas', monospace;
            font-size: 0.8rem;
            color: #d0d0d0;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .json-key {
            color: #9cdcfe;
        }

        .json-string {
            color: #ce9178;
        }

        .json-number {
            color: #b5cea8;
        }

        .json-boolean {
            color: #569cd6;
        }

        .json-null {
            color: #569cd6;
        }

        .copy-buttons {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .copy-btn {
            padding: 6px 12px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        .copy-btn:hover {
            background-color: #2980b9;
        }

        .copy-btn.success {
            background-color: #27ae60;
        }

        .copy-btn.success:hover {
            background-color: #219653;
        }

        .copy-btn.success::after {
            content: "‚úì";
            margin-left: 5px;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .no-json-message {
            color: #95a5a6;
            font-style: italic;
            text-align: center;
            padding: 15px;
        }

        .encoding-badge {
            background-color: #9b59b6;
            padding: 1px 5px;
            border-radius: 3px;
            font-size: 0.65rem;
            margin-left: 3px;
        }

        .no-file-selected {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #888;
            text-align: center;
            padding: 30px 15px;
        }

        .no-file-selected-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            opacity: 0.5;
        }
        
        .preview-warning {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
            padding: 8px 12px;
            margin-bottom: 10px;
            font-size: 0.8rem;
            border-radius: 3px;
            white-space: pre-wrap;
        }
        
        .security-warning {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
            padding: 10px 15px;
            border-radius: 4px;
            font-size: 0.8rem;
            max-width: 300px;
            z-index: 1001;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        @media (max-width: 900px) {
            body {
                padding: 5px;
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .files-panel {
                width: 100%;
                height: 250px;
            }

            .files-panel.collapsed {
                width: 100%;
                height: 40px;
            }

            .files-panel.collapsed .files-list-container {
                display: none;
            }

            .server-params {
                flex-direction: column;
                align-items: flex-start;
                gap: 4px;
            }

            .line-dialog {
                width: 95%;
                max-height: 80vh;
            }

            .copy-buttons {
                flex-direction: column;
            }
            
            .log-controls {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="app-title">
                <span>Web-–ø—Ä–æ—Å–º–æ—Ç—Ä—â–∏–∫ –ª–æ–≥–æ–≤</span>
                <span class="app-version">v{{.Version}}</span>
            </div>
            <div class="server-info">
                <div class="server-status">
                    <div id="status-indicator" class="status-indicator online"></div>
                    <span id="server-status-text">–°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω</span>
                    <span id="last-check" class="last-check">(–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —Ç–æ–ª—å–∫–æ —á—Ç–æ)</span>
                </div>
            </div>
            <div class="server-params">
                <div class="param-item">
                    <span class="param-icon">üìÅ</span>
                    <span>–ö–∞—Ç–∞–ª–æ–≥: {{.LogDirectory}}</span>
                </div>
                <div class="param-item">
                    <span class="param-icon">üìè</span>
                    <span>–õ–∏–º–∏—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞: {{.PreviewSizeMB}} –ú–ë</span>
                </div>
                <div class="param-item">
                    <span class="param-icon">üî§</span>
                    <span>–ö–æ–¥–∏—Ä–æ–≤–∫–∞: {{.Encoding}}</span>
                    <span class="encoding-badge">{{.Encoding}}</span>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <!-- –û–≤–µ—Ä–ª–µ–π –∑–∞–≥—Ä—É–∑–∫–∏ -->
            <div class="loading-overlay" id="loading-overlay">
                <div class="loading-content">
                    <div class="loading"></div>
                    <div style="margin-top: 10px; font-size: 0.9rem;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
            </div>
            
            <div class="files-panel" id="files-panel">
                <div class="files-header">
                    <div class="files-header-content">
                        <div>–§–∞–π–ª—ã –ª–æ–≥–æ–≤</div>
                        <div class="files-controls">
                            <button id="refresh-files-btn" class="btn btn-success">–û–±–Ω–æ–≤–∏—Ç—å</button>
                            <button class="toggle-files-btn" id="toggle-files-btn" title="–°–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å">‚óÄ</button>
                        </div>
                    </div>
                    <div class="files-header-collapsed">
                        <button class="toggle-files-btn" id="toggle-files-btn-collapsed" title="–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å">‚ñ∂</button>
                    </div>
                </div>
                <div class="files-list-container">
                    <ul id="files-list" class="files-list">
                        <li style="padding: 15px; text-align: center;">
                            <div class="loading"></div>
                            <div style="margin-top: 8px; font-size: 0.75rem; color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤...</div>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="log-panel">
                <div class="log-header">
                    <div class="log-title" id="selected-file-name">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</div>
                    <div class="log-controls">
                        <button id="go-top-btn" class="nav-btn" title="–í –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞" disabled>‚Üë –ù–∞—á–∞–ª–æ</button>
                        <button id="go-bottom-btn" class="nav-btn" title="–í –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞" disabled>‚Üì –ö–æ–Ω–µ—Ü</button>
                        <div class="auto-refresh-control">
                            <input type="number" id="refresh-interval" class="interval-input" value="5" min="1" max="60" disabled>
                            <span style="font-size: 0.75rem;">—Å–µ–∫</span>
                            <button id="auto-refresh-file-btn" class="btn" disabled>–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</button>
                        </div>
                    </div>
                </div>
                <div class="log-content-container">
                    <div id="log-content" class="log-content">
                        <div class="no-file-selected">
                            <div class="no-file-selected-icon">üìÑ</div>
                            <h3>–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω</h3>
                            <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –ª–æ–≥–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞ –≤ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏</p>
                            <p style="margin-top: 10px; font-size: 0.8rem; color: #666;">
                                <small>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ñ–∞–π–ª –≤ —Å–ø–∏—Å–∫–µ, —á—Ç–æ–±—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ</small>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="stats">
                    <div class="stats-info" id="stats-info">
                        –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ | –õ–∏–º–∏—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞: {{.PreviewSizeMB}} –ú–ë | –ö–æ–¥–∏—Ä–æ–≤–∫–∞: {{.Encoding}}
                    </div>
                    <div class="stats-refresh" id="auto-refresh-status">
                        –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –≤—ã–∫–ª—é—á–µ–Ω–æ
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ -->
    <div class="line-dialog-overlay" id="line-dialog-overlay">
        <div class="line-dialog">
            <div class="dialog-header">
                <div class="dialog-title">
                    <span>üìù</span>
                    <span id="dialog-line-title">–°—Ç—Ä–æ–∫–∞ #0</span>
                </div>
                <button class="dialog-close" id="dialog-close-btn">√ó</button>
            </div>
            <div class="dialog-content">
                <div class="dialog-section">
                    <div class="dialog-section-title">–ò—Å—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞:</div>
                    <div class="raw-line-content" id="raw-line-content"></div>
                </div>
                
                <div class="dialog-section">
                    <div class="dialog-section-title">–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON:</div>
                    <div class="json-viewer" id="json-viewer">
                        <div class="no-json-message" id="no-json-message">
                            –í —Å—Ç—Ä–æ–∫–µ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω JSON
                        </div>
                    </div>
                </div>
                
                <div class="copy-buttons">
                    <button class="copy-btn" id="copy-raw-btn">
                        üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
                    </button>
                    <button class="copy-btn" id="copy-json-btn">
                        üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================================================
        // –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
        // ============================================================================
        
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞
        let PREVIEW_SIZE = {{.PreviewSize}};
        let PREVIEW_SIZE_MB = {{.PreviewSizeMB}};
        let CURRENT_ENCODING = "{{.Encoding}}";
        let SERVER_BASE_URL = window.location.origin;
        let SERVER_CONNECTED = true;
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const selectedFileNameElement = document.getElementById('selected-file-name');
        const filesListElement = document.getElementById('files-list');
        const filesPanel = document.getElementById('files-panel');
        const toggleFilesBtn = document.getElementById('toggle-files-btn');
        const toggleFilesBtnCollapsed = document.getElementById('toggle-files-btn-collapsed');
        const logContentElement = document.getElementById('log-content');
        const refreshFilesBtn = document.getElementById('refresh-files-btn');
        const autoRefreshFileBtn = document.getElementById('auto-refresh-file-btn');
        const refreshIntervalInput = document.getElementById('refresh-interval');
        const goTopBtn = document.getElementById('go-top-btn');
        const goBottomBtn = document.getElementById('go-bottom-btn');
        const statsInfoElement = document.getElementById('stats-info');
        const autoRefreshStatusElement = document.getElementById('auto-refresh-status');
        const statusIndicator = document.getElementById('status-indicator');
        const serverStatusText = document.getElementById('server-status-text');
        const lastCheckElement = document.getElementById('last-check');
        const loadingOverlay = document.getElementById('loading-overlay');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        const lineDialogOverlay = document.getElementById('line-dialog-overlay');
        const dialogCloseBtn = document.getElementById('dialog-close-btn');
        const dialogLineTitle = document.getElementById('dialog-line-title');
        const rawLineContent = document.getElementById('raw-line-content');
        const jsonViewer = document.getElementById('json-viewer');
        const noJsonMessage = document.getElementById('no-json-message');
        const copyRawBtn = document.getElementById('copy-raw-btn');
        const copyJsonBtn = document.getElementById('copy-json-btn');
        
        // ============================================================================
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        // ============================================================================
        
        let currentFile = null;
        let currentFilePath = null;
        let currentFileSize = null;
        let autoRefreshInterval = null;
        let autoRefreshEnabled = false;
        let healthCheckInterval = null;
        let fileListData = [];
        let currentDialogLineNumber = 0;
        let currentDialogLineContent = '';
        let copySuccessTimeout = null;
        let collapsedDirectories = new Set();
        let lastFileClickTime = 0;
        let isFileLoading = false;
        
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
        const FILE_CLICK_DEBOUNCE = 300; // 300ms –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –¥–≤–æ–π–Ω—ã—Ö –∫–ª–∏–∫–æ–≤
        const HEALTH_CHECK_INTERVAL = 60000; // 60 —Å–µ–∫—É–Ω–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
        const SCROLL_TO_END_DELAY = 100; // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞
        
        // ============================================================================
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        // ============================================================================
        
        /**
         * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
         */
        function init() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
            resetFileSelection();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
            loadFileList();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞
            startHealthCheck();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            initCopyCapabilities();
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞–Ω–µ–ª–∏ —Ñ–∞–π–ª–æ–≤
            restoreFilesPanelState();
            restoreCollapsedDirectories();
            
            // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ–∫–∞ —Ñ–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω
            updateNavigationButtons(false);
        }
        
        // ============================================================================
        // –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–û–°–¢–û–Ø–ù–ò–ï–ú –°–ï–†–í–ï–†–ê
        // ============================================================================
        
        /**
         * –ó–∞–ø—É—Å–∫ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞
         */
        function startHealthCheck() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ —Å—Ä–∞–∑—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
            checkServerHealth();
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
            healthCheckInterval = setInterval(checkServerHealth, HEALTH_CHECK_INTERVAL);
        }
        
        /**
         * –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ API health
         * @returns {Promise<void>}
         */
        async function checkServerHealth() {
            try {
                const response = await fetch(`${SERVER_BASE_URL}/api/health`);
                
                if (response.ok) {
                    const data = await response.json();
                    updateServerStatus(true, data);
                } else {
                    updateServerStatus(false, { error: `HTTP ${response.status}` });
                }
            } catch (error) {
                updateServerStatus(false, { error: error.message });
            }
        }
        
        /**
         * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
         * @param {boolean} isConnected - –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
         * @param {Object} data - –î–∞–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
         */
        function updateServerStatus(isConnected, data) {
            const now = new Date();
            const timeStr = now.toLocaleTimeString();
            
            SERVER_CONNECTED = isConnected;
            
            if (isConnected) {
                statusIndicator.className = 'status-indicator online';
                serverStatusText.textContent = '–°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω';
                lastCheckElement.textContent = `(–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ: ${timeStr})`;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ—Ä–≤–µ—Ä–µ –∏–∑ –¥–∞–Ω–Ω—ã—Ö health
                if (data.previewSize) {
                    PREVIEW_SIZE = data.previewSize;
                    PREVIEW_SIZE_MB = (PREVIEW_SIZE / (1024 * 1024)).toFixed(2);
                }
                
                if (data.encoding) {
                    CURRENT_ENCODING = data.encoding;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateStatsInfo();
            } else {
                statusIndicator.className = 'status-indicator offline';
                serverStatusText.textContent = '–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                lastCheckElement.textContent = `(–ø–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: ${timeStr})`;
                
                if (autoRefreshEnabled) {
                    disableAutoRefresh();
                }
            }
        }
        
        // ============================================================================
        // –£–ü–†–ê–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–û–ú
        // ============================================================================
        
        /**
         * –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
         * @param {boolean} isLoading - –§–ª–∞–≥ –∑–∞–≥—Ä—É–∑–∫–∏
         */
        function setInterfaceLoading(isLoading) {
            if (isLoading) {
                loadingOverlay.classList.add('active');
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                refreshFilesBtn.disabled = true;
                toggleFilesBtn.disabled = true;
                toggleFilesBtnCollapsed.disabled = true;
                goTopBtn.disabled = true;
                goBottomBtn.disabled = true;
                autoRefreshFileBtn.disabled = true;
                refreshIntervalInput.disabled = true;
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã –≤ —Å–ø–∏—Å–∫–µ
                document.querySelectorAll('.file-item').forEach(item => {
                    item.classList.add('disabled');
                });
            } else {
                loadingOverlay.classList.remove('active');
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
                refreshFilesBtn.disabled = false;
                toggleFilesBtn.disabled = false;
                toggleFilesBtnCollapsed.disabled = false;
                
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –µ—Å–ª–∏ —Ñ–∞–π–ª –≤—ã–±—Ä–∞–Ω
                const hasSelectedFile = !!currentFilePath;
                goTopBtn.disabled = !hasSelectedFile;
                goBottomBtn.disabled = !hasSelectedFile;
                autoRefreshFileBtn.disabled = !hasSelectedFile;
                refreshIntervalInput.disabled = !hasSelectedFile;
                
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –≤ —Å–ø–∏—Å–∫–µ
                document.querySelectorAll('.file-item').forEach(item => {
                    item.classList.remove('disabled');
                });
            }
            isFileLoading = isLoading;
        }
        
        /**
         * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
         * @param {boolean} enabled - –í–∫–ª—é—á–µ–Ω—ã –∏–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã
         */
        function updateNavigationButtons(enabled) {
            goTopBtn.disabled = !enabled;
            goBottomBtn.disabled = !enabled;
            autoRefreshFileBtn.disabled = !enabled;
            refreshIntervalInput.disabled = !enabled;
        }
        
        /**
         * –°–±—Ä–æ—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
         */
        function resetFileSelection() {
            currentFile = null;
            currentFilePath = null;
            currentFileSize = null;
            
            // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            selectedFileNameElement.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ "—Ñ–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω"
            logContentElement.innerHTML = `
                <div class="no-file-selected">
                    <div class="no-file-selected-icon">üìÑ</div>
                    <h3>–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω</h3>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –ª–æ–≥–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞ –≤ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏</p>
                    <p style="margin-top: 10px; font-size: 0.8rem; color: #666;">
                        <small>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ñ–∞–π–ª –≤ —Å–ø–∏—Å–∫–µ, —á—Ç–æ–±—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ</small>
                    </p>
                </div>
            `;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            updateStatsInfo();
            
            // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            updateNavigationButtons(false);
        }
        
        /**
         * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
         */
        function updateStatsInfo() {
            if (currentFile) {
                statsInfoElement.textContent = `–§–∞–π–ª: ${currentFile} | –õ–∏–º–∏—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞: ${PREVIEW_SIZE_MB} –ú–ë | –ö–æ–¥–∏—Ä–æ–≤–∫–∞: ${CURRENT_ENCODING}`;
            } else {
                statsInfoElement.textContent = `–û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ | –õ–∏–º–∏—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞: ${PREVIEW_SIZE_MB} –ú–ë | –ö–æ–¥–∏—Ä–æ–≤–∫–∞: ${CURRENT_ENCODING}`;
            }
        }
        
        // ============================================================================
        // –†–ê–ë–û–¢–ê –° –ë–£–§–ï–†–û–ú –û–ë–ú–ï–ù–ê
        // ============================================================================
        
        /**
         * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
         */
        function initCopyCapabilities() {
            if (!isSecureContext()) {
                console.warn('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ.');
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
                showSecurityWarningIfNeeded();
            }
        }
        
        /**
         * –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (HTTPS –∏–ª–∏ localhost)
         * @returns {boolean} –ù–∞—Ö–æ–¥–∏–º—Å—è –ª–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
         */
        function isSecureContext() {
            return window.isSecureContext || 
                   window.location.protocol === 'https:' || 
                   window.location.hostname === 'localhost' || 
                   window.location.hostname === '127.0.0.1' ||
                   window.location.hostname === '[::1]';
        }
        
        /**
         * –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
         */
        function showSecurityWarningIfNeeded() {
            // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ
            if (localStorage.getItem('securityWarningShown')) {
                return;
            }
            
            if (!isSecureContext() && window.location.hostname !== 'localhost' && 
                window.location.hostname !== '127.0.0.1' && window.location.hostname !== '[::1]') {
                
                const warning = document.createElement('div');
                warning.className = 'security-warning';
                
                warning.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 5px;">‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ</div>
                    <div>–î–ª—è —Ä–∞–±–æ—Ç—ã –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.</div>
                    <button onclick="this.parentElement.style.display='none'; localStorage.setItem('securityWarningShown', 'true');" 
                            style="margin-top: 8px; padding: 3px 10px; background-color: #ffc107; border: none; border-radius: 3px; cursor: pointer; font-size: 0.75rem;">
                        –ü–æ–Ω—è—Ç–Ω–æ
                    </button>
                `;
                
                document.body.appendChild(warning);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
                setTimeout(() => {
                    if (warning.parentElement) {
                        warning.style.display = 'none';
                    }
                }, 10000);
            }
        }
        
        /**
         * –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ —Å fallback-–º–µ—Ç–æ–¥–∞–º–∏
         * @param {string} text - –¢–µ–∫—Å—Ç –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
         * @param {HTMLElement} button - –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
         * @returns {Promise<void>}
         */
        async function copyToClipboard(text, button) {
            try {
                // –°–ø–æ—Å–æ–± 1: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π API (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö)
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    await navigator.clipboard.writeText(text);
                } 
                // –°–ø–æ—Å–æ–± 2: –î–æ–∫—É–º–µ–Ω—Ç–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ (—Å—Ç–∞—Ä—ã–π, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)
                else {
                    await copyUsingDocumentExecCommand(text);
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
                button.classList.add('success');
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–∞–π–º–∞—É—Ç
                if (copySuccessTimeout) {
                    clearTimeout(copySuccessTimeout);
                }
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è
                copySuccessTimeout = setTimeout(() => {
                    button.classList.remove('success');
                }, 2000);
                
            } catch (err) {
                console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', err);
                
                // –°–ø–æ—Å–æ–± 3: –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
                showCopyFallbackDialog(text);
            }
        }
        
        /**
         * –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º document.execCommand (—Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥)
         * @param {string} text - –¢–µ–∫—Å—Ç –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
         * @returns {Promise<void>}
         */
        function copyUsingDocumentExecCommand(text) {
            return new Promise((resolve, reject) => {
                try {
                    // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π textarea —ç–ª–µ–º–µ–Ω—Ç
                    const textArea = document.createElement('textarea');
                    textArea.value = text;
                    textArea.style.position = 'fixed';
                    textArea.style.left = '-999999px';
                    textArea.style.top = '-999999px';
                    document.body.appendChild(textArea);
                    
                    // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—Å—Ç
                    textArea.focus();
                    textArea.select();
                    
                    // –ü—ã—Ç–∞–µ–º—Å—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                    const successful = document.execCommand('copy');
                    
                    // –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
                    document.body.removeChild(textArea);
                    
                    if (successful) {
                        resolve();
                    } else {
                        reject(new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è'));
                    }
                } catch (err) {
                    reject(err);
                }
            });
        }
        
        /**
         * –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
         * @param {string} text - –¢–µ–∫—Å—Ç –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
         */
        function showCopyFallbackDialog(text) {
            // –°–æ–∑–¥–∞–µ–º –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            const fallbackDialog = document.createElement('div');
            fallbackDialog.className = 'fallback-copy-dialog';
            fallbackDialog.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.3);
                z-index: 2000;
                max-width: 90%;
                max-height: 90vh;
                display: flex;
                flex-direction: column;
                min-width: 300px;
            `;
            
            fallbackDialog.innerHTML = `
                <div style="margin-bottom: 15px; font-weight: bold; color: #333;">
                    –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç –≤—Ä—É—á–Ω—É—é
                </div>
                <textarea id="fallback-copy-textarea" 
                          style="width: 100%; height: 150px; padding: 10px; 
                                 border: 1px solid #ddd; border-radius: 4px;
                                 font-family: 'Consolas', monospace; font-size: 0.9rem;
                                 resize: vertical; margin-bottom: 15px;">
                    ${text.replace(/</g, '&lt;').replace(/>/g, '&gt;')}
                </textarea>
                <div style="display: flex; justify-content: flex-end; gap: 10px;">
                    <button id="fallback-copy-btn" 
                            style="padding: 8px 16px; background-color: #3498db; 
                                   color: white; border: none; border-radius: 4px;
                                   cursor: pointer;">
                        –í—ã–¥–µ–ª–∏—Ç—å –∏ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                    <button id="fallback-close-btn" 
                            style="padding: 8px 16px; background-color: #e74c3c; 
                                   color: white; border: none; border-radius: 4px;
                                   cursor: pointer;">
                        –ó–∞–∫—Ä—ã—Ç—å
                    </button>
                </div>
                <div style="margin-top: 10px; font-size: 0.8rem; color: #666;">
                    <small>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç–µ–∫—Å—Ç –≤—ã—à–µ, –∑–∞—Ç–µ–º Ctrl+C (Cmd+C –Ω–∞ Mac)</small>
                </div>
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–≤–µ—Ä–ª–µ–π
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0,0,0,0.7);
                z-index: 1999;
            `;
            
            document.body.appendChild(overlay);
            document.body.appendChild(fallbackDialog);
            
            // –§–æ–∫—É—Å–∏—Ä—É–µ–º –∏ –≤—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤ textarea
            const textarea = document.getElementById('fallback-copy-textarea');
            setTimeout(() => {
                textarea.focus();
                textarea.select();
            }, 100);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            document.getElementById('fallback-copy-btn').onclick = () => {
                textarea.focus();
                textarea.select();
                try {
                    const successful = document.execCommand('copy');
                    if (successful) {
                        alert('–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
                    }
                } catch (err) {
                    console.error('Fallback copy failed:', err);
                }
            };
            
            document.getElementById('fallback-close-btn').onclick = () => {
                document.body.removeChild(overlay);
                document.body.removeChild(fallbackDialog);
            };
            
            overlay.onclick = () => {
                document.body.removeChild(overlay);
                document.body.removeChild(fallbackDialog);
            };
        }
        
        // ============================================================================
        // –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –°–¢–†–û–ö–ò –õ–û–ì–ê
        // ============================================================================
        
        /**
         * –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–µ—Ç–∞–ª—è–º–∏ —Å—Ç—Ä–æ–∫–∏ –ª–æ–≥–∞
         * @param {number} lineNumber - –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏
         * @param {string} lineContent - –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–æ–∫–∏
         */
        function showLineDialog(lineNumber, lineContent) {
            currentDialogLineNumber = lineNumber;
            currentDialogLineContent = lineContent;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            dialogLineTitle.textContent = `–°—Ç—Ä–æ–∫–∞ #${lineNumber}`;
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏—Å—Ö–æ–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É
            rawLineContent.textContent = lineContent;
            
            // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å JSON
            const jsonData = tryParseJson(lineContent);
            
            if (jsonData) {
                // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ JSON
                noJsonMessage.style.display = 'none';
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º JSON —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
                const formattedJson = formatJsonWithSyntaxHighlighting(jsonData);
                jsonViewer.innerHTML = formattedJson;
                jsonViewer.style.display = 'block';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è JSON
                copyJsonBtn.style.display = 'flex';
            } else {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ JSON
                noJsonMessage.style.display = 'block';
                jsonViewer.style.display = 'none';
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è JSON
                copyJsonBtn.style.display = 'none';
            }
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            copyRawBtn.classList.remove('success');
            copyJsonBtn.classList.remove('success');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            lineDialogOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        /**
         * –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
         */
        function hideLineDialog() {
            lineDialogOverlay.classList.remove('active');
            document.body.style.overflow = '';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            if (copySuccessTimeout) {
                clearTimeout(copySuccessTimeout);
                copySuccessTimeout = null;
            }
        }
        
        /**
         * –ü–æ–ø—ã—Ç–∫–∞ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON –∏–∑ —Å—Ç—Ä–æ–∫–∏ –ª–æ–≥–∞
         * @param {string} str - –°—Ç—Ä–æ–∫–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
         * @returns {Object|null} –†–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–π JSON –∏–ª–∏ null
         */
        function tryParseJson(str) {
            try {
                // –ò—â–µ–º JSON –≤ —Å—Ç—Ä–æ–∫–µ (–º–æ–∂–µ—Ç –±—ã—Ç—å —á–∞—Å—Ç—å—é —Å—Ç—Ä–æ–∫–∏ –ª–æ–≥–∞)
                const jsonStart = str.indexOf('{');
                const jsonEnd = str.lastIndexOf('}');
                
                if (jsonStart !== -1 && jsonEnd !== -1 && jsonEnd > jsonStart) {
                    const jsonStr = str.substring(jsonStart, jsonEnd + 1);
                    return JSON.parse(jsonStr);
                }
                
                // –ü—Ä–æ–±—É–µ–º —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –≤—Å—é —Å—Ç—Ä–æ–∫—É –∫–∞–∫ JSON
                return JSON.parse(str);
            } catch (e) {
                return null;
            }
        }
        
        /**
         * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JSON —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
         * @param {Object} obj - –û–±—ä–µ–∫—Ç JSON
         * @returns {string} –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π HTML
         */
        function formatJsonWithSyntaxHighlighting(obj) {
            const jsonStr = JSON.stringify(obj, null, 2);
            
            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ JSON
            return jsonStr.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,
                function(match) {
                    let cls = 'json-number';
                    if (/^"/.test(match)) {
                        if (/:$/.test(match)) {
                            cls = 'json-key';
                        } else {
                            cls = 'json-string';
                        }
                    } else if (/true|false/.test(match)) {
                        cls = 'json-boolean';
                    } else if (/null/.test(match)) {
                        cls = 'json-null';
                    }
                    return `<span class="${cls}">${match}</span>`;
                }
            );
        }
        
        // ============================================================================
        // –ù–ê–°–¢–†–û–ô–ö–ê –û–ë–†–ê–ë–û–¢–ß–ò–ö–û–í –°–û–ë–´–¢–ò–ô
        // ============================================================================
        
        /**
         * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
         */
        function setupEventListeners() {
            // –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤
            refreshFilesBtn.addEventListener('click', loadFileList);
            
            // –ö–Ω–æ–ø–∫–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            autoRefreshFileBtn.addEventListener('click', toggleAutoRefreshFile);
            goTopBtn.addEventListener('click', scrollToTop);
            goBottomBtn.addEventListener('click', scrollToBottom);
            
            // –ö–Ω–æ–ø–∫–∏ —Å–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è/—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø–∞–Ω–µ–ª–∏ —Ñ–∞–π–ª–æ–≤
            toggleFilesBtn.addEventListener('click', toggleFilesPanel);
            toggleFilesBtnCollapsed.addEventListener('click', toggleFilesPanel);
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            dialogCloseBtn.addEventListener('click', hideLineDialog);
            lineDialogOverlay.addEventListener('click', (e) => {
                if (e.target === lineDialogOverlay) hideLineDialog();
            });
            
            // –ö–Ω–æ–ø–∫–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
            copyRawBtn.addEventListener('click', () => {
                copyToClipboard(currentDialogLineContent, copyRawBtn);
            });
            
            copyJsonBtn.addEventListener('click', () => {
                const jsonData = tryParseJson(currentDialogLineContent);
                if (jsonData) {
                    const formattedJson = JSON.stringify(jsonData, null, 2);
                    copyToClipboard(formattedJson, copyJsonBtn);
                }
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ Escape
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && lineDialogOverlay.classList.contains('active')) {
                    hideLineDialog();
                }
            });
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            refreshIntervalInput.addEventListener('change', function() {
                let value = parseInt(this.value);
                if (value < 1) this.value = 1;
                if (value > 60) this.value = 60;
                
                // –ï—Å–ª–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å –Ω–æ–≤—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º
                if (autoRefreshEnabled) {
                    clearInterval(autoRefreshInterval);
                    autoRefreshInterval = setInterval(autoRefreshFile, value * 1000);
                    updateAutoRefreshStatus();
                }
            });
        }
        
        /**
         * –°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å —Ñ–∞–π–ª–æ–≤
         */
        function toggleFilesPanel() {
            filesPanel.classList.toggle('collapsed');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–Ω–æ–ø–æ–∫
            const isCollapsed = filesPanel.classList.contains('collapsed');
            
            toggleFilesBtn.title = isCollapsed ? '–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å' : '–°–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å';
            toggleFilesBtnCollapsed.title = isCollapsed ? '–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å' : '–°–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å';
            
            // –ú–µ–Ω—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–µ–ª–æ–∫
            toggleFilesBtn.textContent = isCollapsed ? '‚ñ∂' : '‚óÄ';
            toggleFilesBtnCollapsed.textContent = isCollapsed ? '‚ñ∂' : '‚óÄ';
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ localStorage
            localStorage.setItem('filesPanelCollapsed', isCollapsed);
        }
        
        /**
         * –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞–Ω–µ–ª–∏ —Ñ–∞–π–ª–æ–≤ –∏–∑ localStorage
         */
        function restoreFilesPanelState() {
            const wasCollapsed = localStorage.getItem('filesPanelCollapsed') === 'true';
            if (wasCollapsed) {
                filesPanel.classList.add('collapsed');
                toggleFilesBtn.title = '–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å';
                toggleFilesBtnCollapsed.title = '–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å';
                toggleFilesBtn.textContent = '‚ñ∂';
                toggleFilesBtnCollapsed.textContent = '‚ñ∂';
            }
        }
        
        // ============================================================================
        // –†–ê–ë–û–¢–ê –° –§–ê–ô–õ–ê–ú–ò –ò –ö–ê–¢–ê–õ–û–ì–ê–ú–ò
        // ============================================================================
        
        /**
         * –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞
         * @returns {Promise<void>}
         */
        async function loadFileList() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞
            resetFileSelection();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            filesListElement.innerHTML = '<li style="padding: 15px; text-align: center;"><div class="loading"></div><div style="margin-top: 8px; font-size: 0.75rem; color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤...</div></li>';
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
            refreshFilesBtn.disabled = true;
            
            try {
                const response = await fetch(`${SERVER_BASE_URL}/api/files`);
                
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                fileListData = data.files || [];
                displayFileList(fileListData);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤:', error);
                filesListElement.innerHTML = `<li style="padding: 15px; text-align: center; color: #d32f2f; font-size: 0.8rem;">
                    –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}
                </li>`;
            } finally {
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
                refreshFilesBtn.disabled = false;
            }
        }
        
        /**
         * –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –∫–∞—Ç–∞–ª–æ–≥–∞–º
         * @param {Array} files - –ú–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤
         */
        function displayFileList(files) {
            if (!files || files.length === 0) {
                filesListElement.innerHTML = '<li style="padding: 15px; text-align: center; color: #666; font-size: 0.8rem;">–§–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</li>';
                return;
            }
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –ø–æ –∫–∞—Ç–∞–ª–æ–≥–∞–º
            const filesByDirectory = {};
            files.forEach(file => {
                const dir = file.directory || '(–∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥)';
                if (!filesByDirectory[dir]) {
                    filesByDirectory[dir] = [];
                }
                filesByDirectory[dir].push(file);
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∫–∞—Ç–∞–ª–æ–≥–∏
            const directories = Object.keys(filesByDirectory).sort();
            let html = '';
            
            directories.forEach(dir => {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–≤–µ—Ä–Ω—É—Ç –ª–∏ –∫–∞—Ç–∞–ª–æ–≥
                const isCollapsed = collapsedDirectories.has(dir);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–∞–ª–æ–≥–∞
                if (dir !== '(–∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥)') {
                    html += `
                        <li class="directory-item" data-dir="${dir}">
                            <span>üìÅ ${dir}/</span>
                            <button class="directory-toggle" title="${isCollapsed ? '–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å' : '–°–≤–µ—Ä–Ω—É—Ç—å'}">
                                ${isCollapsed ? '‚ñ∂' : '‚ñº'}
                            </button>
                        </li>
                        <div class="directory-files" ${isCollapsed ? 'style="max-height: 0;"' : ''}>
                    `;
                }
                
                const dirFiles = filesByDirectory[dir];
                dirFiles.forEach(file => {
                    const fileDate = file.modified ? new Date(file.modified).toLocaleDateString() : '–Ω–µ–∏–∑–≤.';
                    const isActive = currentFilePath === file.fullPath ? 'active' : '';
                    
                    html += `
                        <li class="file-item ${isActive}" data-path="${file.fullPath}">
                            <div class="file-info">
                                <div class="file-name">${escapeHtml(file.name)}</div>
                                <div class="file-meta">
                                    <span>${formatFileSize(file.sizeBytes)}</span>
                                    <span>${escapeHtml(fileDate)}</span>
                                </div>
                            </div>
                            <div class="file-actions">
                                <button class="download-btn" title="–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª" data-filename="${file.fullPath}">
                                    –°–∫–∞—á–∞—Ç—å
                                </button>
                            </div>
                        </li>
                    `;
                });
                
                if (dir !== '(–∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥)') {
                    html += `</div>`;
                }
            });
            
            filesListElement.innerHTML = html;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            document.querySelectorAll('.directory-toggle').forEach(btn => {
                btn.addEventListener('click', handleDirectoryToggle);
            });
            
            document.querySelectorAll('.file-item').forEach(item => {
                item.addEventListener('click', handleFileClick);
            });
            
            document.querySelectorAll('.download-btn').forEach(btn => {
                btn.addEventListener('click', handleDownloadClick);
            });
        }
        
        /**
         * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞
         * @param {Event} e - –°–æ–±—ã—Ç–∏–µ –∫–ª–∏–∫–∞
         */
        function handleDirectoryToggle(e) {
            if (isFileLoading) return;
            
            e.stopPropagation();
            const dirItem = e.target.closest('.directory-item');
            const dirName = dirItem.dataset.dir;
            const dirFilesElement = dirItem.nextElementSibling;
            
            if (collapsedDirectories.has(dirName)) {
                collapsedDirectories.delete(dirName);
                dirFilesElement.style.maxHeight = dirFilesElement.scrollHeight + 'px';
                setTimeout(() => {
                    dirFilesElement.style.maxHeight = 'none';
                }, 300);
                e.target.textContent = '‚ñº';
                e.target.title = '–°–≤–µ—Ä–Ω—É—Ç—å';
            } else {
                collapsedDirectories.add(dirName);
                dirFilesElement.style.maxHeight = dirFilesElement.scrollHeight + 'px';
                setTimeout(() => {
                    dirFilesElement.style.maxHeight = '0';
                }, 10);
                e.target.textContent = '‚ñ∂';
                e.target.title = '–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å';
            }
            
            saveCollapsedDirectories();
        }
        
        /**
         * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
         * @param {Event} e - –°–æ–±—ã—Ç–∏–µ –∫–ª–∏–∫–∞
         */
        function handleFileClick(e) {
            if (e.target.classList.contains('download-btn') || isFileLoading) {
                return;
            }
            
            // Debounce –∫–ª–∏–∫–æ–≤
            const now = Date.now();
            if (now - lastFileClickTime < FILE_CLICK_DEBOUNCE) {
                return;
            }
            lastFileClickTime = now;
            
            const fileItem = e.currentTarget;
            const filePath = fileItem.dataset.path;
            
            // –ù–∞—Ö–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ
            const fileInfo = fileListData.find(f => f.fullPath === filePath);
            if (!fileInfo) return;
            
            // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —Ñ–∞–π–ª
            fileItem.classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª
            selectFile(fileInfo);
        }
        
        /**
         * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
         * @param {Event} e - –°–æ–±—ã—Ç–∏–µ –∫–ª–∏–∫–∞
         */
        function handleDownloadClick(e) {
            e.stopPropagation();
            if (isFileLoading) return;
            
            const filePath = e.currentTarget.dataset.filename;
            const fileInfo = fileListData.find(f => f.fullPath === filePath);
            if (fileInfo) {
                downloadFile(fileInfo);
            }
        }
        
        /**
         * –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–µ—Ä–Ω—É—Ç—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –≤ localStorage
         */
        function saveCollapsedDirectories() {
            const directoriesArray = Array.from(collapsedDirectories);
            localStorage.setItem('collapsedDirectories', JSON.stringify(directoriesArray));
        }
        
        /**
         * –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–µ—Ä–Ω—É—Ç—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –∏–∑ localStorage
         */
        function restoreCollapsedDirectories() {
            try {
                const saved = localStorage.getItem('collapsedDirectories');
                if (saved) {
                    const directories = JSON.parse(saved);
                    collapsedDirectories = new Set(directories);
                }
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–≤–µ—Ä–Ω—É—Ç—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤:', e);
                collapsedDirectories = new Set();
            }
        }
        
        /**
         * –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
         * @param {Object} fileInfo - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ
         */
        function selectFile(fileInfo) {
            // –ï—Å–ª–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ, –≤—ã–∫–ª—é—á–∞–µ–º –µ–≥–æ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤
            if (autoRefreshEnabled) {
                disableAutoRefresh();
            }
            
            loadFileContent(fileInfo);
        }
        
        // ============================================================================
        // –ó–ê–ì–†–£–ó–ö–ê –ò –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –õ–û–ì–û–í
        // ============================================================================
        
        /**
         * –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞ –ª–æ–≥–æ–≤
         * @param {Object} fileInfo - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ
         * @returns {Promise<void>}
         */
        async function loadFileContent(fileInfo) {
            currentFile = fileInfo.name;
            currentFilePath = fileInfo.fullPath;
            currentFileSize = fileInfo.sizeBytes;
            selectedFileNameElement.textContent = `–§–∞–π–ª: ${fileInfo.name}`;
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
            setInterfaceLoading(true);
            
            try {
                const response = await fetch(`${SERVER_BASE_URL}/api/file?path=${encodeURIComponent(fileInfo.fullPath)}`);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status} - ${errorText}`);
                }
                
                const content = await response.text();
                displayFileContent(content, fileInfo);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –∫–æ–Ω—Ü—É —Ñ–∞–π–ª–∞
                setTimeout(() => scrollToBottom(), SCROLL_TO_END_DELAY);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞:', error);
                logContentElement.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚ùå</div>
                        <h3>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞</h3>
                        <p>${escapeHtml(error.message)}</p>
                    </div>
                `;
                statsInfoElement.textContent = `–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${fileInfo.name}`;
            } finally {
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
                setInterfaceLoading(false);
                updateNavigationButtons(true);
            }
        }
        
        /**
         * –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞ –ª–æ–≥–æ–≤
         * @param {string} content - –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
         * @param {Object} fileInfo - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ
         */
        function displayFileContent(content, fileInfo) {
            const lines = content.split('\n');
            let html = '';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± –æ–±—Ä–µ–∑–∫–µ)
            let hasPreviewWarning = false;
            let contentStartIndex = 0;
            
            if (lines[0] && lines[0].includes('‚ö†Ô∏è')) {
                hasPreviewWarning = true;
                html += `<div class="preview-warning">${escapeHtml(lines[0])}</div>`;
                contentStartIndex = 1;
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Å–µ —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–µ—Ä–Ω—É–ª —Å–µ—Ä–≤–µ—Ä
            for (let i = contentStartIndex; i < lines.length; i++) {
                const lineNumber = i + 1;
                const escapedLine = escapeHtml(lines[i]);
                const coloredLine = highlightLogLevels(escapedLine);
                
                html += `<div class="log-line" data-line="${lineNumber}">
                    <div class="line-number">${lineNumber}</div>
                    <div class="line-content">${coloredLine}</div>
                </div>`;
            }
            
            logContentElement.innerHTML = html;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –Ω–∞ —Å—Ç—Ä–æ–∫–∏
            document.querySelectorAll('.log-line').forEach(lineElement => {
                lineElement.addEventListener('click', (e) => {
                    const lineNumber = parseInt(lineElement.dataset.line);
                    const lineContent = lines[lineNumber - 1] || '';
                    showLineDialog(lineNumber, lineContent);
                });
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            const now = new Date();
            const timeStr = now.toLocaleTimeString();
            const sizeStr = formatFileSize(fileInfo.sizeBytes);
            const previewSizeMB = PREVIEW_SIZE_MB;
            
            statsInfoElement.textContent = `–§–∞–π–ª: ${currentFile} (${sizeStr}) | –°—Ç—Ä–æ–∫: ${(lines.length - contentStartIndex).toLocaleString()} | –õ–∏–º–∏—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞: ${previewSizeMB} –ú–ë | –ö–æ–¥–∏—Ä–æ–≤–∫–∞: ${CURRENT_ENCODING} | –û–±–Ω–æ–≤–ª–µ–Ω–æ: ${timeStr}`;
        }
        
        /**
         * –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —É—Ä–æ–≤–Ω–µ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ç–µ–∫—Å—Ç–µ
         * @param {string} content - –¢–µ–∫—Å—Ç —Å—Ç—Ä–æ–∫–∏ –ª–æ–≥–∞
         * @returns {string} –¢–µ–∫—Å—Ç —Å HTML-—Ä–∞–∑–º–µ—Ç–∫–æ–π –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏
         */
        function highlightLogLevels(content) {
            return content.replace(/(TRACE|DEBUG|INFO|WARN|WARNING|ERROR|FATAL)/gi, (match) => {
                let color = '#b5cea8';
                const upper = match.toUpperCase();
                switch(upper) {
                    case 'TRACE': color = '#9cdcfe'; break;
                    case 'DEBUG': color = '#4ec9b0'; break;
                    case 'INFO': color = '#b5cea8'; break;
                    case 'WARN':
                    case 'WARNING': color = '#ffd700'; break;
                    case 'ERROR': color = '#f48771'; break;
                    case 'FATAL': color = '#ff0000'; break;
                }
                return `<span style="color: ${color}; font-weight: bold;">${match}</span>`;
            });
        }
        
        /**
         * –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
         * @param {Object} fileInfo - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ
         */
        async function downloadFile(fileInfo) {
            try {
                // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
                window.open(`${SERVER_BASE_URL}/api/download?path=${encodeURIComponent(fileInfo.fullPath)}`, '_blank');
                
                // –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                const originalText = statsInfoElement.textContent;
                statsInfoElement.textContent = `–°–∫–∞—á–∏–≤–∞–Ω–∏–µ "${fileInfo.name}"...`;
                setTimeout(() => {
                    statsInfoElement.textContent = originalText;
                }, 1500);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞:', error);
                alert(`–û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è: ${error.message}`);
            }
        }
        
        // ============================================================================
        // –ê–í–¢–û–û–ë–ù–û–í–õ–ï–ù–ò–ï –°–û–î–ï–†–ñ–ò–ú–û–ì–û –§–ê–ô–õ–ê
        // ============================================================================
        
        /**
         * –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞
         */
        function toggleAutoRefreshFile() {
            if (!SERVER_CONNECTED) {
                alert('–°–µ—Ä–≤–µ—Ä –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω');
                return;
            }
            
            if (!currentFilePath) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞');
                return;
            }
            
            if (autoRefreshEnabled) {
                disableAutoRefresh();
            } else {
                enableAutoRefresh();
            }
        }
        
        /**
         * –í–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
         */
        function enableAutoRefresh() {
            const interval = parseInt(refreshIntervalInput.value) * 1000;
            autoRefreshInterval = setInterval(autoRefreshFile, interval);
            autoRefreshEnabled = true;
            autoRefreshFileBtn.textContent = '–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
            autoRefreshFileBtn.style.backgroundColor = '#d32f2f';
            updateAutoRefreshStatus();
        }
        
        /**
         * –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
         */
        function disableAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
            }
            autoRefreshEnabled = false;
            autoRefreshFileBtn.textContent = '–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ';
            autoRefreshFileBtn.style.backgroundColor = '';
            updateAutoRefreshStatus();
        }
        
        /**
         * –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞
         */
        async function autoRefreshFile() {
            if (!SERVER_CONNECTED || !currentFilePath || !autoRefreshEnabled) return;
            
            try {
                // –ù–∞—Ö–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º —Ñ–∞–π–ª–µ
                const fileInfo = fileListData.find(f => f.fullPath === currentFilePath);
                if (fileInfo) {
                    await loadFileContent(fileInfo);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', error);
            }
        }
        
        /**
         * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
         */
        function updateAutoRefreshStatus() {
            if (autoRefreshEnabled) {
                const interval = refreshIntervalInput.value;
                autoRefreshStatusElement.textContent = `–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –≤–∫–ª—é—á–µ–Ω–æ (${interval} —Å–µ–∫)`;
                autoRefreshStatusElement.style.color = '#2e7d32';
            } else {
                autoRefreshStatusElement.textContent = '–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –≤—ã–∫–ª—é—á–µ–Ω–æ';
                autoRefreshStatusElement.style.color = '#777';
            }
        }
        
        // ============================================================================
        // –ù–ê–í–ò–ì–ê–¶–ò–Ø –ü–û –§–ê–ô–õ–£
        // ============================================================================
        
        /**
         * –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–∞—á–∞–ª—É —Ñ–∞–π–ª–∞
         */
        function scrollToTop() {
            const container = logContentElement.parentElement;
            container.scrollTop = 0;
        }
        
        /**
         * –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –∫–æ–Ω—Ü—É —Ñ–∞–π–ª–∞
         */
        function scrollToBottom() {
            const container = logContentElement.parentElement;
            container.scrollTop = container.scrollHeight;
        }
        
        // ============================================================================
        // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        // ============================================================================
        
        /**
         * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ –≤ —á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥
         * @param {number} bytes - –†–∞–∑–º–µ—Ä –≤ –±–∞–π—Ç–∞—Ö
         * @returns {string} –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä
         */
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 –ë';
            const k = 1024;
            const sizes = ['–ë', '–ö–ë', '–ú–ë', '–ì–ë'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }
        
        /**
         * –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML-—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
         * @param {string} text - –¢–µ–∫—Å—Ç –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
         * @returns {string} –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
         */
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // ============================================================================
        // –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        // ============================================================================
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>